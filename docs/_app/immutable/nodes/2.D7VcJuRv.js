import{a as h,f as S,c as ee}from"../chunks/3MeJAyDi.js";import{i as D}from"../chunks/Biedmao3.js";import{S as E,a2 as H,Y as f,W as b,Z as u,at as v,w as t,a1 as l,_ as R,T as Y,U as N,X as B,V as X,I as V,az as be}from"../chunks/CiiSKS_t.js";import{s as A,e as M}from"../chunks/DNPCJNaY.js";import{i as I}from"../chunks/D0zR2ufV.js";import{e as Z}from"../chunks/hyMIDi62.js";import{r as K,a as W,b as le,s as te}from"../chunks/BSYZh5sJ.js";import{p as q,s as ue,a as de}from"../chunks/J5fKBZMv.js";import{q as k,s as ge}from"../chunks/BOebZ5Rj.js";import{w as _e}from"../chunks/Ble5W72i.js";import{s as we}from"../chunks/BD4U7_I2.js";const oe=`${k.id}:state`;function ve(){return new Date().toISOString()}function ye(o){if(!o)return null;try{const r=JSON.parse(o);return!r||r.version!==1?null:r}catch{return null}}function ce(){const o=ve();return{version:1,startedAt:o,lastSavedAt:o,answers:{}}}function qe(){const o=ce(),r=ye(localStorage.getItem(oe))??o,e=_e(r);return e.subscribe(a=>{try{localStorage.setItem(oe,JSON.stringify(a))}catch{}}),e}const ae=qe();function Se(o,r,e){ae.update(a=>{const m=ve();return a.answers[o]={value:r,otherText:e,updatedAt:m},a.lastSavedAt=m,a})}function Te(){ae.set(ce())}function Ae(){return k.sections.flatMap(o=>o.questions)}function Re(o,r){if(!o.required&&!r||!r)return!1;const e=r.value;switch(o.type){case"text":return typeof e=="string"&&e.trim().length>0;case"rating":return typeof e=="number"&&e>=o.min&&e<=o.max;case"single":return typeof e!="string"||e.length===0?!1:o.allowOtherText&&e==="other"?(r.otherText??"").trim().length>0:!0;case"multi":{if(!Array.isArray(e))return!1;const a=o.required?o.minSelect??1:0;return e.length<a?!1:o.allowOtherText&&e.includes("other")?(r.otherText??"").trim().length>0:!0}}}function Ce(o){const e=Ae().filter(d=>d.required!==!1),a=e.filter(d=>Re(d,o.answers[d.id])),m=e.length===0?0:Math.round(a.length/e.length*100);return{answered:a.length,total:e.length,pct:m}}var ke=S('<input class="w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:border-slate-400" placeholder="Please specify…"/>'),Oe=S('<label class="flex cursor-pointer items-center gap-3 rounded-lg border border-slate-200 bg-white px-3 py-2 hover:bg-slate-50"><input type="radio" class="h-4 w-4"/> <span class="text-sm text-slate-800"> </span></label> <!>',1),ze=S('<div class="space-y-2"></div>');function Le(o,r){E(r,!1);let e=q(r,"question",8),a=q(r,"value",8),m=q(r,"otherText",8),d=q(r,"onChange",8);function x(c){d()(c,c==="other"?m():void 0)}function g(c){d()(a()??"other",c)}D();var i=ze();Z(i,5,()=>(v(e()),l(()=>e().options)),c=>c.id,(c,s)=>{var n=Oe(),p=H(n),_=f(p);K(_);var w=b(_,2),O=f(w,!0);u(w),u(p);var Q=b(p,2);{var C=z=>{var T=ke();K(T),R(()=>te(T,m())),M("input",T,j=>g(j.currentTarget.value)),h(z,T)};I(Q,z=>{v(e()),t(s),v(a()),l(()=>e().allowOtherText&&t(s).id==="other"&&a()==="other")&&z(C)})}R(()=>{W(_,"name",(v(e()),l(()=>e().id))),le(_,(v(a()),t(s),l(()=>a()===t(s).id))),A(O,(t(s),l(()=>t(s).label)))}),M("change",_,()=>x(t(s).id)),h(c,n)}),u(i),h(o,i),Y()}var Ie=S('<input class="w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:border-slate-400" placeholder="Please specify…"/>'),je=S('<label class="flex cursor-pointer items-center gap-3 rounded-lg border border-slate-200 bg-white px-3 py-2 hover:bg-slate-50"><input type="checkbox" class="h-4 w-4"/> <span class="text-sm text-slate-800"> </span></label> <!>',1),Pe=S('<div class="space-y-2"></div>');function Me(o,r){E(r,!1);const e=V();let a=q(r,"question",8),m=q(r,"value",8),d=q(r,"otherText",8),x=q(r,"onChange",8);function g(s){const n=t(e).includes(s)?t(e).filter(p=>p!==s):[...t(e),s];x()(n,n.includes("other")?d():void 0)}function i(s){const n=t(e).includes("other")?t(e):[...t(e),"other"];x()(n,s)}N(()=>v(m()),()=>{B(e,Array.isArray(m())?m():[])}),X(),D();var c=Pe();Z(c,5,()=>(v(a()),l(()=>a().options)),s=>s.id,(s,n)=>{var p=je(),_=H(p),w=f(_);K(w);var O=b(w,2),Q=f(O,!0);u(O),u(_);var C=b(_,2);{var z=T=>{var j=Ie();K(j),R(()=>te(j,d())),M("input",j,U=>i(U.currentTarget.value)),h(T,j)};I(C,T=>{v(a()),t(n),t(e),l(()=>a().allowOtherText&&t(n).id==="other"&&t(e).includes("other"))&&T(z)})}R(T=>{le(w,T),A(Q,(t(n),l(()=>t(n).label)))},[()=>(t(e),t(n),l(()=>t(e).includes(t(n).id)))]),M("change",w,()=>g(t(n).id)),h(s,p)}),u(c),h(o,c),Y()}var Qe=S('<button type="button"> </button>'),Ue=S('<div class="flex justify-between text-xs text-slate-600"><span> </span> <span> </span></div>'),De=S('<div class="flex flex-col gap-2"><div class="flex flex-wrap gap-2"></div> <!></div>');function Ee(o,r){E(r,!1);const e=V();let a=q(r,"question",8),m=q(r,"value",8),d=q(r,"onChange",8);N(()=>v(m()),()=>{B(e,typeof m()=="number"?m():0)}),X(),D();var x=De(),g=f(x);Z(g,5,()=>(v(a()),l(()=>Array(a().max-a().min+1).fill(0).map((s,n)=>a().min+n))),s=>s,(s,n)=>{var p=Qe(),_=f(p,!0);u(p),R(()=>{we(p,1,`min-w-10 rounded-lg border px-3 py-2 text-sm font-medium transition
					${t(e)===t(n)?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-white text-slate-800 hover:bg-slate-50"}`),W(p,"aria-pressed",t(e)===t(n)),A(_,t(n))}),M("click",p,()=>d()(t(n))),h(s,p)}),u(g);var i=b(g,2);{var c=s=>{var n=Ue(),p=f(n),_=f(p,!0);u(p);var w=b(p,2),O=f(w,!0);u(w),u(n),R(()=>{A(_,(v(a()),l(()=>a().minLabel??""))),A(O,(v(a()),l(()=>a().maxLabel??"")))}),h(s,n)};I(i,s=>{v(a()),l(()=>a().minLabel||a().maxLabel)&&s(c)})}u(x),h(o,x),Y()}var Ye=S('<textarea class="min-h-24 w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:border-slate-400"></textarea>'),Je=S('<input class="w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:border-slate-400"/>');function Ne(o,r){E(r,!1);const e=V();let a=q(r,"question",8),m=q(r,"value",8),d=q(r,"onChange",8);N(()=>v(m()),()=>{B(e,typeof m()=="string"?m():"")}),X(),D();var x=ee(),g=H(x);{var i=s=>{var n=Ye();be(n),R(()=>{W(n,"placeholder",(v(a()),l(()=>a().placeholder??"Type your answer…"))),te(n,t(e))}),M("input",n,p=>d()(p.currentTarget.value)),h(s,n)},c=s=>{var n=Je();K(n),R(()=>{W(n,"placeholder",(v(a()),l(()=>a().placeholder??"Type your answer…"))),te(n,t(e))}),M("input",n,p=>d()(p.currentTarget.value)),h(s,n)};I(g,s=>{v(a()),l(()=>a().multiline)?s(i):s(c,!1)})}h(o,x),Y()}var Be=S('<span class="ml-2 text-xs font-semibold text-slate-500">Required</span>'),Ve=S('<div class="mt-1 text-xs text-slate-600"> </div>'),Fe=S('<div class="rounded-xl border border-slate-100 bg-slate-50 p-4"><div class="flex items-start justify-between gap-3"><div><div class="text-sm font-medium text-slate-900"> <!></div> <!></div></div> <div class="mt-3"><!></div></div>');function Ge(o,r){E(r,!1);const e=()=>ue(ae,"$quizState",a),[a,m]=de(),d=V(),x=V(),g=V();let i=q(r,"question",8);function c(y,L){Se(i().id,y,L)}N(()=>(e(),v(i())),()=>{B(d,e().answers[i().id])}),N(()=>t(d),()=>{B(x,t(d)?.value)}),N(()=>t(d),()=>{B(g,t(d)?.otherText??"")}),X(),D();var s=Fe(),n=f(s),p=f(n),_=f(p),w=f(_),O=b(w);{var Q=y=>{var L=Be();h(y,L)};I(O,y=>{v(i()),l(()=>i().required!==!1)&&y(Q)})}u(_);var C=b(_,2);{var z=y=>{var L=Ve(),P=f(L,!0);u(L),R(()=>A(P,(v(i()),l(()=>i().help)))),h(y,L)};I(C,y=>{v(i()),l(()=>i().help)&&y(z)})}u(p),u(n);var T=b(n,2),j=f(T);{var U=y=>{Le(y,{get question(){return i()},get value(){return t(x)},get otherText(){return t(g)},onChange:c})},$=y=>{var L=ee(),P=H(L);{var J=F=>{Me(F,{get question(){return i()},get value(){return t(x)},get otherText(){return t(g)},onChange:c})},re=F=>{var ne=ee(),fe=H(ne);{var me=G=>{Ee(G,{get question(){return i()},get value(){return t(x)},onChange:c})},pe=G=>{var ie=ee(),xe=H(ie);{var he=se=>{Ne(se,{get question(){return i()},get value(){return t(x)},onChange:c})};I(xe,se=>{v(i()),l(()=>i().type==="text")&&se(he)},!0)}h(G,ie)};I(fe,G=>{v(i()),l(()=>i().type==="rating")?G(me):G(pe,!1)},!0)}h(F,ne)};I(P,F=>{v(i()),l(()=>i().type==="multi")?F(J):F(re,!1)},!0)}h(y,L)};I(j,y=>{v(i()),l(()=>i().type==="single")?y(U):y($,!1)})}u(T),u(s),R(()=>A(w,`${v(i()),l(()=>i().prompt)??""} `)),h(o,s),Y(),m()}var He=S('<p class="mt-1 text-sm text-slate-600"> </p>'),Ke=S('<section class="rounded-2xl border border-slate-200 bg-white p-5 shadow-sm"><h2 class="text-base font-semibold"> </h2> <!> <div class="mt-4 space-y-4"></div></section>');function We(o,r){E(r,!1);let e=q(r,"section",8);D();var a=Ke(),m=f(a),d=f(m,!0);u(m);var x=b(m,2);{var g=c=>{var s=He(),n=f(s,!0);u(s),R(()=>A(n,(v(e()),l(()=>e().description)))),h(c,s)};I(x,c=>{v(e()),l(()=>e().description)&&c(g)})}var i=b(x,2);Z(i,5,()=>(v(e()),l(()=>e().questions)),c=>c.id,(c,s)=>{Ge(c,{get question(){return t(s)}})}),u(i),u(a),R(()=>A(d,(v(e()),l(()=>e().title)))),h(o,a),Y()}var Xe=S('<div class="sticky top-0 z-20 border-b border-slate-200 bg-white/80 backdrop-blur"><div class="mx-auto flex max-w-3xl items-center gap-3 px-4 py-3"><div class="flex-1"><div class="flex items-baseline justify-between"><div class="text-sm font-medium text-slate-900"> </div> <div class="text-xs text-slate-500"> </div></div> <div class="mt-2 h-2 w-full rounded-full bg-slate-100"><div class="h-2 rounded-full bg-slate-900 transition-[width] duration-300"></div></div></div> <button type="button" class="rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-800 hover:bg-slate-100">Reset</button></div></div>');function Ze(o,r){E(r,!1);let e=q(r,"prog",8),a=q(r,"lastSavedAt",8),m=q(r,"onReset",8);function d(C){return new Date(C).toLocaleString()}D();var x=Xe(),g=f(x),i=f(g),c=f(i),s=f(c),n=f(s);u(s);var p=b(s,2),_=f(p);u(p),u(c);var w=b(c,2),O=f(w);u(w),u(i);var Q=b(i,2);u(g),u(x),R(C=>{A(n,`${v(e()),l(()=>e().pct)??""}% complete`),A(_,`Saved: ${C??""}`),ge(O,`width: ${v(e()),l(()=>e().pct)??""}%`)},[()=>(v(a()),l(()=>d(a())))]),M("click",Q,function(...C){m()?.apply(this,C)}),h(o,x),Y()}function $e(o){const r={questionnaireId:k.id,submittedAt:new Date().toISOString(),answers:o.answers},e=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),a=URL.createObjectURL(e),m=document.createElement("a");m.href=a,m.download=`questionnaire-submission-${Date.now()}.json`,m.click(),URL.revokeObjectURL(a)}var et=S('<p class="mt-2 text-sm text-slate-500"> </p>'),tt=S('<div class="min-h-screen bg-slate-50 text-slate-900"><!> <main class="mx-auto max-w-3xl px-4 pb-24 pt-6"><header class="mb-6"><h1 class="text-2xl font-semibold tracking-tight"> </h1> <p class="mt-2 text-sm text-slate-600"> </p> <!></header> <div class="space-y-6"></div> <div class="mt-10 rounded-2xl border border-slate-200 bg-white p-5 shadow-sm"><h2 class="text-base font-semibold">Finish</h2> <p class="mt-1 text-sm text-slate-600">Your progress is saved automatically on this device.</p> <div class="mt-4 flex flex-wrap items-center gap-3"><button class="rounded-xl bg-slate-900 px-4 py-2 text-sm font-medium text-white hover:bg-slate-800" type="button">Continue</button> <button class="rounded-xl border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-800 hover:bg-slate-100" type="button">Reset</button> <span class="text-sm text-slate-500"> </span></div></div></main></div>');function at(o,r){E(r,!1);const e=()=>ue(ae,"$quizState",a),[a,m]=de(),d=V();function x(){$e(e()),alert("Your responses have been downloaded. Please send the file as instructed.")}function g(){confirm("Reset all answers? This will clear your saved progress on this device.")&&(Te(),scrollTo({top:0,behavior:"smooth"}))}N(()=>e(),()=>{B(d,Ce(e()))}),X(),D();var i=tt(),c=f(i);Ze(c,{get prog(){return t(d)},get lastSavedAt(){return e(),l(()=>e().lastSavedAt)},onReset:g});var s=b(c,2),n=f(s),p=f(n),_=f(p,!0);u(p);var w=b(p,2),O=f(w,!0);u(w);var Q=b(w,2);{var C=P=>{var J=et(),re=f(J);u(J),R(()=>A(re,`Estimated completion time: ${v(k),l(()=>k.estimatedMinutes)??""} minutes`)),h(P,J)};I(Q,P=>{v(k),l(()=>k.estimatedMinutes)&&P(C)})}u(n);var z=b(n,2);Z(z,5,()=>(v(k),l(()=>k.sections)),P=>P.id,(P,J)=>{We(P,{get section(){return t(J)}})}),u(z);var T=b(z,2),j=b(f(T),4),U=f(j),$=b(U,2),y=b($,2),L=f(y);u(y),u(j),u(T),u(s),u(i),R(()=>{A(_,(v(k),l(()=>k.title))),A(O,(v(k),l(()=>k.intro))),U.disabled=(t(d),l(()=>t(d).pct<100)),W(U,"title",(t(d),l(()=>t(d).pct<100?"Complete required questions to enable submission.":"Ready"))),A(L,`Required answered: ${t(d),l(()=>t(d).answered)??""} / ${t(d),l(()=>t(d).total)??""} (${t(d),l(()=>t(d).pct)??""}%)`)}),M("click",U,x),M("click",$,g),h(o,i),Y(),m()}function mt(o){at(o,{})}export{mt as component};
