import{a as b,f as S,c as ee}from"../chunks/Ct8hVUib.js";import{i as M}from"../chunks/B-aGsofq.js";import{h as oe,C as Q,D as V,G as m,I as g,H as d,x as c,w as a,g as l,E as C,F as U,a_ as Y,W as B,a$ as X,V as F}from"../chunks/DJ6dxAbS.js";import{s as A,e as P}from"../chunks/CdfOKeRi.js";import{p as q,i as I,s as ue,a as de}from"../chunks/D1HYs85v.js";import{t as ge,q as k,e as Z,s as _e}from"../chunks/C6BFq5hD.js";import{r as K,s as W,a as ce,b as te,c as we}from"../chunks/OZRRphnT.js";import{w as ye}from"../chunks/lvQnyv2M.js";function qe(i,r,e,t,f,u){var x=i.__className;if(oe||x!==e||x===void 0){var h=ge(e);(!oe||h!==i.getAttribute("class"))&&(h==null?i.removeAttribute("class"):i.className=h),i.__className=e}return u}const le=`${k.id}:state`;function ve(){return new Date().toISOString()}function Se(i){if(!i)return null;try{const r=JSON.parse(i);return!r||r.version!==1?null:r}catch{return null}}function fe(){const i=ve();return{version:1,startedAt:i,lastSavedAt:i,answers:{}}}function Te(){const i=fe(),r=Se(localStorage.getItem(le))??i,e=ye(r);return e.subscribe(t=>{try{localStorage.setItem(le,JSON.stringify(t))}catch{}}),e}const ae=Te();function Ae(i,r,e){ae.update(t=>{const f=ve();return t.answers[i]={value:r,otherText:e,updatedAt:f},t.lastSavedAt=f,t})}function Ce(){ae.set(fe())}function Re(){return k.sections.flatMap(i=>i.questions)}function ke(i,r){if(!i.required&&!r||!r)return!1;const e=r.value;switch(i.type){case"text":return typeof e=="string"&&e.trim().length>0;case"rating":return typeof e=="number"&&e>=i.min&&e<=i.max;case"single":return typeof e!="string"||e.length===0?!1:i.allowOtherText&&e==="other"?(r.otherText??"").trim().length>0:!0;case"multi":{if(!Array.isArray(e))return!1;const t=i.required?i.minSelect??1:0;return e.length<t?!1:i.allowOtherText&&e.includes("other")?(r.otherText??"").trim().length>0:!0}}}function Oe(i){const e=Re().filter(u=>u.required!==!1),t=e.filter(u=>ke(u,i.answers[u.id])),f=e.length===0?0:Math.round(t.length/e.length*100);return{answered:t.length,total:e.length,pct:f}}var Le=S('<input class="w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:border-slate-400" placeholder="Please specify…"/>'),ze=S('<label class="flex cursor-pointer items-center gap-3 rounded-lg border border-slate-200 bg-white px-3 py-2 hover:bg-slate-50"><input type="radio" class="h-4 w-4"/> <span class="text-sm text-slate-800"> </span></label> <!>',1),Ie=S('<div class="space-y-2"></div>');function je(i,r){Q(r,!1);let e=q(r,"question",8),t=q(r,"value",8),f=q(r,"otherText",8),u=q(r,"onChange",8);function x(v){u()(v,v==="other"?f():void 0)}function h(v){u()(t()??"other",v)}M();var o=Ie();Z(o,5,()=>(c(e()),l(()=>e().options)),v=>v.id,(v,s)=>{var n=ze(),p=V(n),_=m(p);K(_);var w=g(_,2),O=m(w,!0);d(w),d(p);var D=g(p,2);{var R=L=>{var T=Le();K(T),C(()=>te(T,f())),P("input",T,j=>h(j.currentTarget.value)),b(L,T)};I(D,L=>{c(e()),a(s),c(t()),l(()=>e().allowOtherText&&a(s).id==="other"&&t()==="other")&&L(R)})}C(()=>{W(_,"name",(c(e()),l(()=>e().id))),ce(_,(c(t()),a(s),l(()=>t()===a(s).id))),A(O,(a(s),l(()=>a(s).label)))}),P("change",_,()=>x(a(s).id)),b(v,n)}),d(o),b(i,o),U()}var Ne=S('<input class="w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:border-slate-400" placeholder="Please specify…"/>'),Pe=S('<label class="flex cursor-pointer items-center gap-3 rounded-lg border border-slate-200 bg-white px-3 py-2 hover:bg-slate-50"><input type="checkbox" class="h-4 w-4"/> <span class="text-sm text-slate-800"> </span></label> <!>',1),De=S('<div class="space-y-2"></div>');function Ee(i,r){Q(r,!1);const e=F();let t=q(r,"question",8),f=q(r,"value",8),u=q(r,"otherText",8),x=q(r,"onChange",8);function h(s){const n=a(e).includes(s)?a(e).filter(p=>p!==s):[...a(e),s];x()(n,n.includes("other")?u():void 0)}function o(s){const n=a(e).includes("other")?a(e):[...a(e),"other"];x()(n,s)}Y(()=>c(f()),()=>{B(e,Array.isArray(f())?f():[])}),X(),M();var v=De();Z(v,5,()=>(c(t()),l(()=>t().options)),s=>s.id,(s,n)=>{var p=Pe(),_=V(p),w=m(_);K(w);var O=g(w,2),D=m(O,!0);d(O),d(_);var R=g(_,2);{var L=T=>{var j=Ne();K(j),C(()=>te(j,u())),P("input",j,E=>o(E.currentTarget.value)),b(T,j)};I(R,T=>{c(t()),a(n),a(e),l(()=>t().allowOtherText&&a(n).id==="other"&&a(e).includes("other"))&&T(L)})}C(T=>{ce(w,T),A(D,(a(n),l(()=>a(n).label)))},[()=>(a(e),a(n),l(()=>a(e).includes(a(n).id)))]),P("change",w,()=>h(a(n).id)),b(s,p)}),d(v),b(i,v),U()}var Me=S('<button type="button"> </button>'),Qe=S('<div class="flex justify-between text-xs text-slate-600"><span> </span> <span> </span></div>'),Ue=S('<div class="flex flex-col gap-2"><div class="flex flex-wrap gap-2"></div> <!></div>');function Je(i,r){Q(r,!1);const e=F();let t=q(r,"question",8),f=q(r,"value",8),u=q(r,"onChange",8);Y(()=>c(f()),()=>{B(e,typeof f()=="number"?f():0)}),X(),M();var x=Ue(),h=m(x);Z(h,5,()=>(c(t()),l(()=>Array(t().max-t().min+1).fill(0).map((s,n)=>t().min+n))),s=>s,(s,n)=>{var p=Me(),_=m(p,!0);d(p),C(()=>{qe(p,1,`min-w-10 rounded-lg border px-3 py-2 text-sm font-medium transition
					${a(e)===a(n)?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-white text-slate-800 hover:bg-slate-50"}`),W(p,"aria-pressed",a(e)===a(n)),A(_,a(n))}),P("click",p,()=>u()(a(n))),b(s,p)}),d(h);var o=g(h,2);{var v=s=>{var n=Qe(),p=m(n),_=m(p,!0);d(p);var w=g(p,2),O=m(w,!0);d(w),d(n),C(()=>{A(_,(c(t()),l(()=>t().minLabel??""))),A(O,(c(t()),l(()=>t().maxLabel??"")))}),b(s,n)};I(o,s=>{c(t()),l(()=>t().minLabel||t().maxLabel)&&s(v)})}d(x),b(i,x),U()}var Ye=S('<textarea class="min-h-24 w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:border-slate-400"></textarea>'),Be=S('<input class="w-full rounded-lg border border-slate-200 bg-white px-3 py-2 text-sm outline-none focus:border-slate-400"/>');function Fe(i,r){Q(r,!1);const e=F();let t=q(r,"question",8),f=q(r,"value",8),u=q(r,"onChange",8);Y(()=>c(f()),()=>{B(e,typeof f()=="string"?f():"")}),X(),M();var x=ee(),h=V(x);{var o=s=>{var n=Ye();we(n),C(()=>{W(n,"placeholder",(c(t()),l(()=>t().placeholder??"Type your answer…"))),te(n,a(e))}),P("input",n,p=>u()(p.currentTarget.value)),b(s,n)},v=s=>{var n=Be();K(n),C(()=>{W(n,"placeholder",(c(t()),l(()=>t().placeholder??"Type your answer…"))),te(n,a(e))}),P("input",n,p=>u()(p.currentTarget.value)),b(s,n)};I(h,s=>{c(t()),l(()=>t().multiline)?s(o):s(v,!1)})}b(i,x),U()}var Ge=S('<span class="ml-2 text-xs font-semibold text-slate-500">Required</span>'),He=S('<div class="mt-1 text-xs text-slate-600"> </div>'),Ve=S('<div class="rounded-xl border border-slate-100 bg-slate-50 p-4"><div class="flex items-start justify-between gap-3"><div><div class="text-sm font-medium text-slate-900"> <!></div> <!></div></div> <div class="mt-3"><!></div></div>');function Ke(i,r){Q(r,!1);const e=()=>ue(ae,"$quizState",t),[t,f]=de(),u=F(),x=F(),h=F();let o=q(r,"question",8);function v(y,z){Ae(o().id,y,z)}Y(()=>(e(),c(o())),()=>{B(u,e().answers[o().id])}),Y(()=>a(u),()=>{B(x,a(u)?.value)}),Y(()=>a(u),()=>{B(h,a(u)?.otherText??"")}),X(),M();var s=Ve(),n=m(s),p=m(n),_=m(p),w=m(_),O=g(w);{var D=y=>{var z=Ge();b(y,z)};I(O,y=>{c(o()),l(()=>o().required!==!1)&&y(D)})}d(_);var R=g(_,2);{var L=y=>{var z=He(),N=m(z,!0);d(z),C(()=>A(N,(c(o()),l(()=>o().help)))),b(y,z)};I(R,y=>{c(o()),l(()=>o().help)&&y(L)})}d(p),d(n);var T=g(n,2),j=m(T);{var E=y=>{je(y,{get question(){return o()},get value(){return a(x)},get otherText(){return a(h)},onChange:v})},$=y=>{var z=ee(),N=V(z);{var J=G=>{Ee(G,{get question(){return o()},get value(){return a(x)},get otherText(){return a(h)},onChange:v})},re=G=>{var ne=ee(),me=V(ne);{var pe=H=>{Je(H,{get question(){return o()},get value(){return a(x)},onChange:v})},xe=H=>{var ie=ee(),he=V(ie);{var be=se=>{Fe(se,{get question(){return o()},get value(){return a(x)},onChange:v})};I(he,se=>{c(o()),l(()=>o().type==="text")&&se(be)},!0)}b(H,ie)};I(me,H=>{c(o()),l(()=>o().type==="rating")?H(pe):H(xe,!1)},!0)}b(G,ne)};I(N,G=>{c(o()),l(()=>o().type==="multi")?G(J):G(re,!1)},!0)}b(y,z)};I(j,y=>{c(o()),l(()=>o().type==="single")?y(E):y($,!1)})}d(T),d(s),C(()=>A(w,`${c(o()),l(()=>o().prompt)??""} `)),b(i,s),U(),f()}var We=S('<p class="mt-1 text-sm text-slate-600"> </p>'),Xe=S('<section class="rounded-2xl border border-slate-200 bg-white p-5 shadow-sm"><h2 class="text-base font-semibold"> </h2> <!> <div class="mt-4 space-y-4"></div></section>');function Ze(i,r){Q(r,!1);let e=q(r,"section",8);M();var t=Xe(),f=m(t),u=m(f,!0);d(f);var x=g(f,2);{var h=v=>{var s=We(),n=m(s,!0);d(s),C(()=>A(n,(c(e()),l(()=>e().description)))),b(v,s)};I(x,v=>{c(e()),l(()=>e().description)&&v(h)})}var o=g(x,2);Z(o,5,()=>(c(e()),l(()=>e().questions)),v=>v.id,(v,s)=>{Ke(v,{get question(){return a(s)}})}),d(o),d(t),C(()=>A(u,(c(e()),l(()=>e().title)))),b(i,t),U()}var $e=S('<div class="sticky top-0 z-20 border-b border-slate-200 bg-white/80 backdrop-blur"><div class="mx-auto flex max-w-3xl items-center gap-3 px-4 py-3"><div class="flex-1"><div class="flex items-baseline justify-between"><div class="text-sm font-medium text-slate-900"> </div> <div class="text-xs text-slate-500"> </div></div> <div class="mt-2 h-2 w-full rounded-full bg-slate-100"><div class="h-2 rounded-full bg-slate-900 transition-[width] duration-300"></div></div></div> <button type="button" class="rounded-xl border border-slate-300 bg-white px-3 py-2 text-sm font-medium text-slate-800 hover:bg-slate-100">Reset</button></div></div>');function et(i,r){Q(r,!1);let e=q(r,"prog",8),t=q(r,"lastSavedAt",8),f=q(r,"onReset",8);function u(R){return new Date(R).toLocaleString()}M();var x=$e(),h=m(x),o=m(h),v=m(o),s=m(v),n=m(s);d(s);var p=g(s,2),_=m(p);d(p),d(v);var w=g(v,2),O=m(w);d(w),d(o);var D=g(o,2);d(h),d(x),C(R=>{A(n,`${c(e()),l(()=>e().pct)??""}% complete`),A(_,`Saved: ${R??""}`),_e(O,`width: ${c(e()),l(()=>e().pct)??""}%`)},[()=>(c(t()),l(()=>u(t())))]),P("click",D,function(...R){f()?.apply(this,R)}),b(i,x),U()}function tt(i){const r={questionnaireId:k.id,submittedAt:new Date().toISOString(),answers:i.answers},e=new Blob([JSON.stringify(r,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),f=document.createElement("a");f.href=t,f.download=`questionnaire-submission-${Date.now()}.json`,f.click(),URL.revokeObjectURL(t)}var at=S('<p class="mt-2 text-sm text-slate-500"> </p>'),rt=S('<div class="min-h-screen bg-slate-50 text-slate-900"><!> <main class="mx-auto max-w-3xl px-4 pb-24 pt-6"><header class="mb-6"><h1 class="text-2xl font-semibold tracking-tight"> </h1> <p class="mt-2 text-sm text-slate-600"> </p> <!></header> <div class="space-y-6"></div> <div class="mt-10 rounded-2xl border border-slate-200 bg-white p-5 shadow-sm"><h2 class="text-base font-semibold">Finish</h2> <p class="mt-1 text-sm text-slate-600">Your progress is saved automatically on this device.</p> <div class="mt-4 flex flex-wrap items-center gap-3"><button class="rounded-xl bg-slate-900 px-4 py-2 text-sm font-medium text-white hover:bg-slate-800" type="button">Continue</button> <button class="rounded-xl border border-slate-300 bg-white px-4 py-2 text-sm font-medium text-slate-800 hover:bg-slate-100" type="button">Reset</button> <span class="text-sm text-slate-500"> </span></div></div></main></div>');function st(i,r){Q(r,!1);const e=()=>ue(ae,"$quizState",t),[t,f]=de(),u=F();function x(){tt(e()),alert("Your responses have been downloaded. Please send the file as instructed.")}function h(){confirm("Reset all answers? This will clear your saved progress on this device.")&&(Ce(),scrollTo({top:0,behavior:"smooth"}))}Y(()=>e(),()=>{B(u,Oe(e()))}),X(),M();var o=rt(),v=m(o);et(v,{get prog(){return a(u)},get lastSavedAt(){return e(),l(()=>e().lastSavedAt)},onReset:h});var s=g(v,2),n=m(s),p=m(n),_=m(p,!0);d(p);var w=g(p,2),O=m(w,!0);d(w);var D=g(w,2);{var R=N=>{var J=at(),re=m(J);d(J),C(()=>A(re,`Estimated completion time: ${c(k),l(()=>k.estimatedMinutes)??""} minutes`)),b(N,J)};I(D,N=>{c(k),l(()=>k.estimatedMinutes)&&N(R)})}d(n);var L=g(n,2);Z(L,5,()=>(c(k),l(()=>k.sections)),N=>N.id,(N,J)=>{Ze(N,{get section(){return a(J)}})}),d(L);var T=g(L,2),j=g(m(T),4),E=m(j),$=g(E,2),y=g($,2),z=m(y);d(y),d(j),d(T),d(s),d(o),C(()=>{A(_,(c(k),l(()=>k.title))),A(O,(c(k),l(()=>k.intro))),E.disabled=(a(u),l(()=>a(u).pct<100)),W(E,"title",(a(u),l(()=>a(u).pct<100?"Complete required questions to enable submission.":"Ready"))),A(z,`Required answered: ${a(u),l(()=>a(u).answered)??""} / ${a(u),l(()=>a(u).total)??""} (${a(u),l(()=>a(u).pct)??""}%)`)}),P("click",E,x),P("click",$,h),b(i,o),U(),f()}function ft(i){st(i,{})}export{ft as component};
